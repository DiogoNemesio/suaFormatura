<form id="zgFormFiltroCRLisID" class="form-horizontal">
<input type="hidden" id="indFiltrado" name="indFiltrado" value="1">
<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
	<h4 class=""><i class="fa fa-search blue"></i>&nbsp;%TITULO%</h4>
</div>
<div class="modal-body" style="overflow-y: scroll; height: 400px;">
	<div class="row">
		<div class="col-sm-6">
			<div><label for="instituicaoID">Instituição de ensino:</label></div>
			<div class="form-group col-sm-12" id="divInstituicaoID">
				<div class="input-group col-sm-12 pull-left">
					<input type="hidden" id="instituicaoID" name="instituicao" class="width-100"  data-rel="select2Instituicao">								    	
				</div>
			</div>
			<div><label for="cursoID">Curso:</label></div>
			<div class="form-group col-sm-12" id="divCursoID">
				<div class="input-group col-sm-12 pull-left">	    		
					<input type="hidden" id="cursoID" name="curso" class="width-100"  data-rel="select2Curso">								    	
				</div>
			</div>
			<div><label for="instituicaoID">Cidade da formatura:</label></div>
			<div class="form-group col-sm-12" id="divCidadeID">
				<div class="input-group col-sm-12 pull-left">	    			
					<input type="hidden" id="cidadeID" name="cidade" class="width-100"  data-rel="select2Cidade">								    	
				</div>
			</div>
			<div><label for="dataCadID">Data do cadastro:</label></div>
			<div class="form-group col-sm-12">
				<div class="col-sm-8 input-group input-daterange pul-left">
					<input type="text" class="input-sm form-control" id="dataCadIniID" name="dataCadIni" placeholder="Data inicial" maxlength='10' autocomplete='off' zg-data-toggle='mask' zg-data-mask='data'/>
					<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
					<input type="text" class="input-sm form-control" id="dataCadFimID" name="dataCadFim" placeholder="Data final" maxlength='10' autocomplete='off' zg-data-toggle='mask' zg-data-mask='data'/>
				</div>
			</div>
			<div><label for="dataCadID">Data prevista de conclusão:</label></div>
			<div class="form-group col-sm-12">
				<div class="col-sm-8 input-group input-daterange pul-left">
					<input type="text" class="input-sm form-control" id="dataPrevIniID" name="dataPrevIni" placeholder="Data inicial" maxlength='10' autocomplete='off' zg-data-toggle='mask' zg-data-mask='data'/>
					<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
					<input type="text" class="input-sm form-control" id="dataPrevFimID" name="dataPrevFim" placeholder="Data final" maxlength='10' autocomplete='off' zg-data-toggle='mask' zg-data-mask='data'/>
				</div>
			</div>
		</div>
		<div class="col-sm-6">
	    	<div class="col-sm-12">
	    		<div><label for="codStatusID">Status:</label></div>
				<div class="form-group">
	    			<div class="input-group col-sm-12">
						<select class="multiselect" multiple="multiple" name="codStatus[]" id="codStatusID">
						%STATUS%
						</select>
					</div>
				</div>
	    	</div>
	    	<div class="col-sm-12">
	    		<div><label for="codUsuarioCadID">Usuário que cadastro:</label></div>
				<div class="form-group">
	    			<div class="input-group col-sm-12">
						<select class="multiselect" multiple="multiple" name="codUsuarioCad[]" id="codUsuarioCadID">
						%CENTRO_CUSTO%
						</select>
					</div>
				</div>
			</div>
		</div>
    </div>
</div>
<div class="modal-footer">
	<button type="submit" class="btn btn-primary" id="btnSubmitID">Pesquisar</button>
	<button type="button" data-dismiss="modal" class="btn" id="cancel">Fechar</button>
</div>
</form>

<script type="text/javascript" charset="%CHARSET%">

/*********************************************************
* Busca Select2 typehead Instituição
*********************************************************/
$('[data-rel="select2Instituicao"]').select2({
    minimumInputLength: 2,
    placeholder: 'Buscar instituição de ensino',
    allowClear: true,
    ajax: { // instead of writing the function to execute the request we use Select2's convenient helper
        url: "%ROOT_URL%/Fmt/getInstituicao.dp.php",
        dataType: 'json',
        quietMillis: 250,
        data: function (term, page) {
            return {
                q: term, // search term
            };
        },
        results: function (data) {
			return {results: data};
		},
        cache: true
    },
});

/*********************************************************
* Busca Select2 typehead Cursos
*********************************************************/
$('[data-rel="select2Curso"]').select2({
    minimumInputLength: 2,
    placeholder: 'Buscar o curso',
    allowClear: true,
    ajax: { // instead of writing the function to execute the request we use Select2's convenient helper
        url: "%ROOT_URL%/Fmt/getCurso.dp.php",
        dataType: 'json',
        quietMillis: 250,
        data: function (term, page) {
            return {
                q: term, // search term
            };
        },
        results: function (data) {
			return {results: data};
		},
        cache: true
    },
});

/*********************************************************
* Busca Select2 typehead Cidades
*********************************************************/
$('[data-rel="select2Cidade"]').select2({
    minimumInputLength: 2,
    placeholder: 'Buscar a cidade',
    allowClear: true,
    ajax: { // instead of writing the function to execute the request we use Select2's convenient helper
        url: "%ROOT_URL%/Adm/getCidadeLis.dp.php",
        dataType: 'json',
        quietMillis: 250,
        data: function (term, page) {
            return {
                q: term, // search term
            };
        },
        results: function (data) {
			return {results: data};
		},
        cache: true
    },
});

$('#zgFormFiltroCRLisID').submit(function() {
	
	$('#btnSubmitID').html('Aguarde...  <i class="ace-icon fa fa-spinner fa-spin orange bigger-125"></i>');
	$('#btnSubmitID').attr("disabled","disabled");
	$('#cancel').attr("disabled","disabled");

	/** Retirar a máscara para os campos que estão configurados para tal **/
	$('[zg-data-mask-retira="1"]').each(function( index ) {
		$( this ).val($( this ).cleanVal());
	});

	$("#zgSpinnerID").removeClass("hidden");
	$('#zgDivModalID').modal('hide');
	
	$.ajax({
		type:	"POST", 
		url:	"%FILTER_URL%",
		data:	$('#zgFormFiltroCRLisID').serialize(),
	}).done(function( data, textStatus, jqXHR) {
		$("#%DIVCENTRAL%ID").html( data );
		$("#zgSpinnerID").addClass("hidden");
		
	});

	//Voltar o botão de salvar
	$('#btnSubmitID').html('Pesquisar');
	$('#btnSubmitID').attr("disabled",false);
	$('#cancel').attr("disabled",false);

	/** Recolocar a máscara para os campos que estão configurados para tal **/
	$('[zg-data-mask-retira="1"]').each(function( index ) {
		zgMask($( this ), $( this ).attr('zg-data-mask'));
		$( this ).trigger('keyup');
	});
		
	return false; 
});

$(".nav-tabs a[data-toggle=tab]").on("click", function(e) {
	if ($(this).hasClass("disabled")) {
		e.preventDefault();
		return false;
	}
});

$('#codStatusID').multiselect({
	enableFiltering: false,
	includeSelectAllOption: true,
	disableIfEmpty: true,
	buttonWidth: '100%',
	buttonClass: 'btn btn-white btn-primary btn-sm',
	nonSelectedText: 'Status',
	allSelectedText: 'Todos status',
	nSelectedText: 'selecionados',
	selectAllText: 'Marcar todos',
	numberDisplayed: 2,
});

$('#codUsuarioCadID').multiselect({
	enableFiltering: false,
	includeSelectAllOption: true,
	disableIfEmpty: true,
	buttonWidth: '100%',
	buttonClass: 'btn btn-white btn-primary btn-sm',
	nonSelectedText: 'Usuário que cadastrou',
	allSelectedText: 'Todos os usuários',
	nSelectedText: 'selecionados',
	selectAllText: 'Marcar todos',
	numberDisplayed: 2,
});

$('[data-rel=tooltip]').tooltip({html:true});
$('[data-rel=popover]').popover({html:true});
$('[data-rel="select2"]').select2();

$('[zg-data-toggle="mask"]').each(function( index ) {
	zgMask($( this ), $( this ).attr('zg-data-mask'));
});

$('.input-daterange').datepicker({"autoclose": true});

$(document).one('ajaxloadstart.page', function(e) {
	$('[class*=select2]').remove();
	$('.rating').raty('destroy');
	$('.multiselect').multiselect('destroy');
});


</script>
